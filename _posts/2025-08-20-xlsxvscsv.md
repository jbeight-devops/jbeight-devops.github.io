---
layout: single
title: "첨부파일 - xlsx와 csv"
date: 2025-08-25 13:00:00 +0900
categories: MIS Episode
share: true
---

[문의]
사내 GPT 시스템에서 엑셀 첨부하는데 빙글빙글 돌아요.
사용자가 업로드하였던 파일은 8MB 엑셀파일이였다.

관련해서 알게된 사실
CSV 파일이 엑셀(xlsx) 파일보다 용량이 훨씬 커진 이유는 다음과 같은 기술적인 차이 때문입니다

✅ 정리
• XLSX: 구조화된 압축 저장 → 작음 (8MB)
• CSV: 텍스트 기반 비압축 + 긴 문자열 + 이스케이프 문자 → 큼 (40MB)

⸻

📌 1. 문자열 데이터 길이와 이스케이프 처리
• 질문/답변 형태의 데이터는 대개 긴 텍스트로 구성됩니다.
• CSV에서는 각 셀의 텍스트가 큰따옴표(")로 감싸지고, 내부의 줄바꿈이나 쉼표는 이스케이프 문자("" 또는 \n, \r)로 처리됩니다.
• 이로 인해 실제 텍스트보다 훨씬 많은 문자 수가 들어가며, 파일 크기도 증가합니다.

⸻

📌 2. 멀티라인/줄바꿈 문제
• 질문/답변 데이터에 줄바꿈(엔터)이 들어 있을 경우, CSV 파일에서 이를 "문자열\n문자열" 형태로 처리합니다.
• Excel은 이를 압축하여 보관하지만, CSV는 그대로 출력되므로 크기가 커질 수 있습니다.

⸻

📌 3. UTF-8 BOM 및 인코딩
• CSV 파일이 UTF-8 BOM을 포함하거나, 다국어 텍스트가 있을 경우 한 글자당 2~4바이트가 사용됩니다.
• xlsx는 이를 효율적으로 압축하지만, CSV는 그대로 반영되어 용량이 더 커질 수 있습니다.

⸻

이런 이유 였구나,
사용자가 첨부하는 엑셀파일을 CSV 형태로 변환하고, 전처리 (줄바꿈,쉼표 삭제 등)를 하는 로직을 적용해보는건 어떨까 확인 해봐야겠다.
